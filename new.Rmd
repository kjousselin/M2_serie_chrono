---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
dossier = '/users/2023/ds2/118003905/M2_serie_chrono/'
data = read.csv("export_nb_par_semaine.csv", sep = ',')
data
```
```{r}
library(stats)
library(tseries)
library(TSA)
#library(xts)
#library(forecast)
```
```{r}
print(length(data[,2]))
data = data[c(2:137),]
data

```



```{r}
#data$week = as.Date(data$week)
ts_data = ts(data$publishedAt, frequency = 5)
ts_data
```


```{r}
plot(ts_data)
```


```{r}
l_ts = log(ts_data)
plot(l_ts)
```


```{r}
acf(l_ts, lag = 40)
```
```{r}
pacf(l_ts, lag =40)
```
#Test de stationnarité du modèle

```{r}
adf.test(l_ts)    # H0 Non Stationnaire   : REJETE
```


```{r}
kpss.test(l_ts)   # H0 Stationnaire       : ACCEPTE
```


```{r}
Box.test(l_ts, type="Ljung-Box", lag=5)   # H0 pas d'autocorrélation : est-ce un bruit blanc ?
```
```{r}
plot(l_ts)

```


```{r}
dec_ts = decompose(l_ts, type = "additive")
plot(dec_ts)
```


```{r}
plot(dec_ts$trend, type="l", col="blue", ylab="Tendance")
plot(dec_ts$seasonal, type="l", col="red", ylab="Périodicité")
plot(dec_ts$figure, type="l", col="magenta", ylab="Motif périodique")
plot(dec_ts$random[3:10], type="l", col="forestgreen", ylab="Fluctuation")
```

```{r}
random_ts = dec_ts$random[3:134]

```



```{r}
adf.test(random_ts)   # H0 Non Stationnaire   : REJETE
kpss.test(random_ts)  # H0 Stationnaire       : ACCEPTE
```


```{r}
adf.test(l_ts)   # H0 Non Stationnaire   : REJETE
kpss.test(l_ts)  # H0 Stationnaire       : ACCEPTE
```


Modèle proposé par AutoArima de Forecast :
```{r}
library("forecast")
auto.arima(l_ts)
```

